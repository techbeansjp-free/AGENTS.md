# Storybookルール追加レビュー

**レビュー実施日**: 2025年12月20日 05:36:34  
**レビュー対象**: Storybook / デザインシステム運用規約（`AGENTS_STORYBOOK_RULES.md`）の追加と既存ドキュメントへの参照追加  
**レビュー担当者**: AI エージェント  
**レビュー基準**: [`AGENTS_REVIEW_RULE.md`](../AGENTS_REVIEW_RULE.md)

---

## レビュー概要

### レビュー目的

Storybookによるデザインシステム管理を統一するため、`AGENTS_STORYBOOK_RULES.md`を追加し、既存のAGENTSドキュメントに参照を追加しました。本レビューでは、追加された規約の整合性と既存ドキュメントへの参照追加状況を確認します。

### レビュー対象ファイル

#### 新規作成ファイル

1. [`AGENTS_STORYBOOK_RULES.md`](../AGENTS_STORYBOOK_RULES.md) - Storybook / デザインシステム運用規約
   - Storybook論理構造（固定）の定義
   - 各階層の役割（AI用定義）
   - デザイントークンの絶対ルール
   - コンポーネントの書き方（固定テンプレート）
   - UI Stackとの対応
   - 禁止事項
   - LLMエージェント向け実行ルール
   - AI自己チェックリスト
   - 判断フロー（AIが迷ったとき）

#### 更新ファイル

1. [`AGENTS.md`](../AGENTS.md) - 開発規約の完全版
   - 参考資料セクションの「AGENTS 規約ドキュメント」に`AGENTS_STORYBOOK_RULES.md`への参照を追加
   - 最終更新日を更新（2025年12月20日）

2. [`AGENTS_AI_PLAYBOOK.md`](../AGENTS_AI_PLAYBOOK.md) - AI エージェント向けの実行ルール
   - ハード制約にStorybook生成時のルール参照を追加（項目14）
   - 最終更新日を更新（2025年12月20日）

---

## レビュー結果サマリー

### ✅ 良好な点

1. **包括的なルール定義**: `AGENTS_STORYBOOK_RULES.md`に、Storybook論理構造、各階層の役割、デザイントークンの管理ルール、コンポーネントの記述方法、UI Stackとの対応、禁止事項など、Storybookによるデザインシステム管理に必要な包括的なルールが定義されている

2. **適切な参照設定**: `AGENTS.md`と`AGENTS_AI_PLAYBOOK.md`に、`AGENTS_STORYBOOK_RULES.md`への適切な参照が追加されている

3. **AI向けの明確なルール**: LLMエージェント向け実行ルール、AI自己チェックリスト、判断フロー（AIが迷ったとき）が明確に定義されており、AIがStorybookを生成する際の指針が明確になっている

4. **固定テンプレートの提供**: コンポーネントの書き方（固定テンプレート）が明確に定義されており、一貫性のあるStorybookドキュメントを作成できる

5. **デザイントークンの管理ルール**: デザイントークンの絶対ルールが明確に定義されており、トークン定義の一元管理が徹底されている

6. **Storybook論理構造の固定**: Storybook論理構造（固定）が明確に定義されており、階層名・階層順・public/adminの対称構造が変更禁止として明示されている

7. **判断フローの提供**: AIがコンポーネントの配置に迷ったときの判断フローが明確に定義されており、適切な配置が可能になっている

8. **禁止事項の明確化**: 禁止事項（違反扱い）が明確に定義されており、誤った実装を防ぐことができる

### ⚠️ 改善が必要な点

**なし** - すべての項目が適切に実装されています。

---

## 詳細レビュー結果

### 1. `AGENTS_STORYBOOK_RULES.md` の確認

#### ✅ クイックリファレンス

- 絶対に守ること5項目が明確に定義されている
  - Storybookは「論理構造」で管理する
  - デザイントークンは「01_デザイン基盤」が唯一の正
  - UIは「役割 → 状態 → 構造 → 見た目」の順で定義する
  - コンポーネントの記述順を守る
  - すべてのコンポーネントにStorybookストーリーを作成する

#### ✅ Storybook論理構造（固定）

- Storybook論理構造が明確に定義されている
  - イントロダクション（MDX）
  - フロント（public）: 01_デザイン基盤 → 02_最小UI部品 → 03_UIコンポーネント → 04_画面パターン → 05_レイアウト雛形 → 06_画面例（URI）
  - 管理画面（admin）: 同様の構造
- 変更禁止事項（階層名、階層順、public/adminの対称構造）が明確に記載されている

#### ✅ 各階層の役割

- 各階層（イントロダクション、01_デザイン基盤、02_最小UI部品、03_UIコンポーネント、04_画面パターン、05_レイアウト雛形、06_画面例）の役割が明確に定義されている
- 各階層に含まれるものと禁止事項が明確に記載されている

#### ✅ デザイントークンの絶対ルール

- トークンの置き場所（01_デザイン基盤のみ）が明確に定義されている
- コンポーネント側の扱い（参照するだけ、定義しない）が明確に定義されている
- 書いてよいものと書いてはいけないものが明確に記載されている
- SemanticトークンとPrimitiveトークンの区別が明確に説明されている

#### ✅ コンポーネントの書き方（固定テンプレート）

- 記述順（必須）が明確に定義されている
  - 概要 → 役割 → 状態一覧 → 振る舞い → 構造 → 使用トークン → アクセシビリティ → 使用上の注意
- テンプレート例（Button.stories.tsx）が提供されている

#### ✅ UI Stackとの対応

- UI Stackの各要素とStorybookの配置場所の対応関係が明確に定義されている

#### ✅ 禁止事項（違反扱い）

- 5つの禁止事項が明確に記載されている
  - コンポーネント内でトークン定義
  - Storyに色コードを書く
  - 06_画面例に仕様を書く
  - 見た目だけで状態を定義
  - 「なんとなく共通」を作る

#### ✅ LLMエージェント向け実行ルール

- 共通前提が明確に定義されている
- 5つの実行ルールが明確に定義されている
  - Storybook論理構造の遵守
  - デザイントークンの管理
  - コンポーネントの記述順
  - コンポーネントの配置判断
  - Storybookストーリーの必須項目

#### ✅ AI自己チェックリスト

- Storybook生成時の自己チェック項目が明確に定義されている（13項目）
- チェックリストの使い方が説明されている

#### ✅ 判断フロー（AIが迷ったとき）

- AIがコンポーネントの配置に迷ったときの判断フローが明確に定義されている
- 判断基準の詳細が明確に説明されている

#### ✅ 最終宣言（AI用）

- 4つの最終宣言が明確に記載されている
  - デザイントークンは01_デザイン基盤が唯一の正
  - コンポーネントは役割と状態を語る
  - 見た目の根拠は必ずトークンに遡れる
  - Storybookは設計書であり、カタログではない

#### ✅ 参考資料

- プロジェクトドキュメントへの参照が適切に記載されている
- 外部参考資料への参照が適切に記載されている

#### ✅ 最後に（人間向け）

- 迷ったときの指針が明確に記載されている

### 2. `AGENTS.md` の更新確認

#### ✅ 参考資料セクション

- 「AGENTS 規約ドキュメント」に`AGENTS_STORYBOOK_RULES.md`への参照が適切に追加されている
- 既存の参照（`AGENTS_AI_PLAYBOOK.md`、`AGENTS_REVIEW_RULE.md`、`AGENTS_TEST_GUIDELINES.md`、`AGENTS_MERMAID_RULES.md`）との整合性が保たれている

#### ✅ 最終更新日

- 最終更新日が適切に更新されている（2025年12月20日）

### 3. `AGENTS_AI_PLAYBOOK.md` の更新確認

#### ✅ ハード制約

- ハード制約にStorybook生成時のルール参照が適切に追加されている（項目14）
- 既存のハード制約（項目13: Mermaid図作成時）との整合性が保たれている
- 参照先が明確に記載されている（`AGENTS_STORYBOOK_RULES.md`）

#### ✅ 最終更新日

- 最終更新日が適切に更新されている（2025年12月20日）

---

## 整合性確認

### ✅ ドキュメント間の整合性

1. **参照の一貫性**: `AGENTS.md`と`AGENTS_AI_PLAYBOOK.md`から`AGENTS_STORYBOOK_RULES.md`への参照が適切に設定されている

2. **命名規則の一貫性**: ファイル名、セクション名、参照形式が既存のAGENTSドキュメントと一貫している

3. **フォーマットの一貫性**: ドキュメントのフォーマット（見出し、セクション構造、リンク形式）が既存のAGENTSドキュメントと一貫している

### ✅ 既存規約との整合性

1. **AGENTS.mdとの整合性**: StorybookルールがAGENTS.mdの開発規約の全体像と整合している

2. **AGENTS_AI_PLAYBOOK.mdとの整合性**: StorybookルールがAGENTS_AI_PLAYBOOK.mdのLLMエージェント運用ルールと整合している

3. **他のAGENTS規約との整合性**: Storybookルールが他のAGENTS規約（Mermaidルール、テストガイドライン等）と整合している

---

## 改善提案

### ✅ 現時点での改善提案

**なし** - すべての項目が適切に実装されており、現時点での改善提案はありません。

---

## 総合評価

### ✅ 総合評価: **合格**

すべての項目が適切に実装されており、Storybookによるデザインシステム管理のための包括的な規約が整備されています。AIエージェントがStorybookを生成する際の明確な指針が提供されており、一貫性のあるStorybookドキュメントを作成できる体制が整っています。

### ✅ 主な成果

1. **包括的なルール定義**: Storybook論理構造、各階層の役割、デザイントークンの管理ルール、コンポーネントの記述方法など、Storybookによるデザインシステム管理に必要な包括的なルールが定義されている

2. **AI向けの明確な指針**: LLMエージェント向け実行ルール、AI自己チェックリスト、判断フローが明確に定義されており、AIがStorybookを生成する際の指針が明確になっている

3. **適切な参照設定**: 既存のAGENTSドキュメント（`AGENTS.md`、`AGENTS_AI_PLAYBOOK.md`）に適切な参照が追加されている

4. **一貫性の確保**: 既存のAGENTS規約との整合性が保たれており、ドキュメント間の一貫性が確保されている

---

## 承認

本レビュー結果を承認し、以下のファイルを正式版として確定します：

- ✅ [`AGENTS_STORYBOOK_RULES.md`](../AGENTS_STORYBOOK_RULES.md)
- ✅ [`AGENTS.md`](../AGENTS.md)（更新版）
- ✅ [`AGENTS_AI_PLAYBOOK.md`](../AGENTS_AI_PLAYBOOK.md)（更新版）

---

**レビュー完了日**: 2025年12月20日 05:36:34

