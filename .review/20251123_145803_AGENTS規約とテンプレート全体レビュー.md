# AGENTS規約とテンプレート全体レビュー

**レビュー実施日**: 2025年11月23日  
**レビュー対象**: AGENTS規約と全テンプレートファイル  
**レビュー担当者**: AI エージェント

---

## レビュー概要

AGENTS規約（`AGENTS.md`、`AGENTS_AI_PLAYBOOK.md`）と全テンプレートファイル（`.workflow/templates/`）の整合性、一貫性、完全性を確認しました。

---

## レビュー結果サマリー

### ✅ 良好な点

1. **テンプレートの基本構造**: すべてのテンプレートが適切な構造を持っている
2. **プレースホルダーの統一**: プレースホルダーの形式が統一されている
3. **Mermaid図の活用**: 適切にMermaid図が使用されている
4. **ドキュメント原則の反映**: 「生きているドキュメント」の原則が各テンプレートに反映されている

### ⚠️ 改善が必要な点

1. **`00_システム理解.md`の「前のステップ」「次のステップ」セクション**: AGENTS.mdでは「前のステップ/次のステップセクションは不要」と明記されているが、テンプレートには含まれている
2. **`00_要求定義.md`の「前のステップ」セクション**: 最初のドキュメントのため不要だが、テンプレートには含まれていない（これは正しい）
3. **`04_review.md`の「次のステップ」セクション**: 最終確認フェーズへのリンクが含まれているが、AGENTS.mdの記述と整合性を確認する必要がある

---

## 詳細レビュー結果

### 1. `00_システム理解.md`

#### ✅ 良好な点

- メタデータセクションが適切に配置されている
- システム概要、アーキテクチャ、データベース、API設計などの必須項目が含まれている
- 参考資料セクションに既存ドキュメントへのリンクが含まれている
- Mermaid図の使用例が適切

#### ⚠️ 改善が必要な点

- **「前のステップ」「次のステップ」セクション**: 
  - 現在のテンプレート（288-296行目）には「前のステップ」「次のステップ」セクションが含まれている
  - しかし、AGENTS.md（575行目）では「前のステップ/次のステップセクションは不要（プロジェクト全体の理解のため）」と明記されている
  - **推奨**: テンプレートから「前のステップ」「次のステップ」セクションを削除し、代わりに「参考資料」セクションのみを残す

#### 📝 修正提案

```markdown
## 参考資料

### プロジェクトドキュメント

- [README](./README.md)
- [設計書](./docs/design.md)
- [API 仕様書](./docs/api-spec.md)
- {その他のドキュメント}

### 外部資料

- {外部資料へのリンク}

---

**最終更新**: {YYYY 年 MM 月 DD 日}
```

---

### 2. `00_要求定義.md`

#### ✅ 良好な点

- 「前のステップ」セクションが含まれていない（最初のドキュメントのため正しい）
- 「次のステップ」セクションに`01_要件定義.md`へのリンクが含まれている
- 既存プロジェクトの場合の`00_システム理解.md`への参照が含まれている
- マインドマップとMermaid図が適切に使用されている
- 「プロジェクト名」と「issue/タスク名」の使い分けについての注意書きが含まれている

#### ✅ 確認事項

- すべての必須項目が含まれている
- リンク形式が正しい（Markdownリンク形式）

---

### 3. `01_要件定義.md`

#### ✅ 良好な点

- 「前のステップ」セクションに`00_要求定義.md`へのリンクが含まれている
- 「次のステップ」セクションに`02_設計.md`へのリンクが含まれている
- BDDユースケース（Feature）とシナリオ（Scenario）のテンプレートが含まれている
- Gherkin形式とMermaid図が適切に使用されている

#### ✅ 確認事項

- すべての必須項目が含まれている
- リンク形式が正しい

---

### 4. `02_設計.md`

#### ✅ 良好な点

- 「前のステップ」セクションに`01_要件定義.md`へのリンクが含まれている
- 「次のステップ」セクションに`03_実装計画.md`へのリンクが含まれている
- アーキテクチャパターンの選択肢（レイヤード、クリーンアーキテクチャ）が含まれている
- ER図、フローチャート、シーケンス図などのMermaid図が適切に使用されている

#### ✅ 確認事項

- すべての必須項目が含まれている
- リンク形式が正しい

---

### 5. `03_実装計画.md`

#### ✅ 良好な点

- 「前のステップ」セクションに`02_設計.md`へのリンクが含まれている
- 「次のステップ」セクションに`90_issues.md`または実装フェーズへのリンクが含まれている
- BDD形式のテストケーステンプレートが含まれている
- タスクとissueの使い分けについての注意書きが含まれている
- Gantt図が適切に使用されている

#### ✅ 確認事項

- すべての必須項目が含まれている
- リンク形式が正しい

---

### 6. `04_review.md`

#### ✅ 良好な点

- 「前のステップ」セクションに`03_実装計画.md`へのリンクが含まれている
- 「次のステップ」セクションに`05_最終確認チェックリスト.md`またはissue/タスク完了へのリンクが含まれている
- レビュー項目が網羅的に含まれている
- テストカバレッジの可視化（Mermaid pie chart）が含まれている

#### ✅ 確認事項

- すべての必須項目が含まれている
- リンク形式が正しい
- AGENTS.mdの記述（628行目）と整合している

---

### 7. `05_最終確認チェックリスト.md`

#### ✅ 良好な点

- 「参考資料」セクションにプロジェクトドキュメントへのリンクが含まれている
- 「前のステップ」「次のステップ」セクションが含まれていない（最終確認チェックリストのため正しい）
- 外部設定項目のチェックリスト形式が適切

#### ✅ 確認事項

- すべての必須項目が含まれている
- リンク形式が正しい
- AGENTS.mdの記述（638行目）と整合している

---

### 8. `90_issues.md`

#### ✅ 良好な点

- 「参考資料」セクションに親issue/タスクのドキュメントへのリンクが含まれている
- 「前のステップ」「次のステップ」セクションが含まれていない（issue管理ファイルのため正しい）
- issueとタスクの使い分けについての説明が含まれている
- 進捗状況の可視化（Mermaid pie chart）が含まれている

#### ✅ 確認事項

- すべての必須項目が含まれている
- リンク形式が正しい
- AGENTS.mdの記述（620行目）と整合している

---

## テンプレート間の整合性チェック

### リンク形式の統一性

✅ **良好**: すべてのテンプレートでMarkdownリンク形式（`[ファイル名.md](./ファイル名.md)`）が使用されている

### プレースホルダーの統一性

✅ **良好**: すべてのテンプレートで`{プロジェクト名}`、`{YYYY 年 MM 月 DD 日}`などのプレースホルダー形式が統一されている

### セクション構造の統一性

✅ **良好**: すべてのテンプレートで適切なセクション構造が使用されている

---

## AGENTS.mdとの整合性チェック

### 必須セクションの確認

| テンプレート | 前のステップ | 次のステップ | AGENTS.mdとの整合性 |
|------------|------------|------------|-------------------|
| `00_システム理解.md` | ❌ 不要だが含まれている | ❌ 不要だが含まれている | ⚠️ **要修正** |
| `00_要求定義.md` | ✅ 不要（最初のドキュメント） | ✅ 含まれている | ✅ 整合 |
| `01_要件定義.md` | ✅ 含まれている | ✅ 含まれている | ✅ 整合 |
| `02_設計.md` | ✅ 含まれている | ✅ 含まれている | ✅ 整合 |
| `03_実装計画.md` | ✅ 含まれている | ✅ 含まれている | ✅ 整合 |
| `04_review.md` | ✅ 含まれている | ✅ 含まれている | ✅ 整合 |
| `05_最終確認チェックリスト.md` | ✅ 不要 | ✅ 不要 | ✅ 整合 |
| `90_issues.md` | ✅ 不要 | ✅ 不要 | ✅ 整合 |

---

## 修正が必要な項目

### 1. `00_システム理解.md`の「前のステップ」「次のステップ」セクション

**問題**: AGENTS.mdでは「前のステップ/次のステップセクションは不要（プロジェクト全体の理解のため）」と明記されているが、テンプレートには含まれている

**修正内容**: 
- 288-296行目の「前のステップ」「次のステップ」セクションを削除
- 代わりに「参考資料」セクションのみを残す

**修正後の形式**:

```markdown
## 参考資料

### プロジェクトドキュメント

- [README](./README.md)
- [設計書](./docs/design.md)
- [API 仕様書](./docs/api-spec.md)
- {その他のドキュメント}

### 外部資料

- {外部資料へのリンク}

---

**最終更新**: {YYYY 年 MM 月 DD 日}
```

---

## その他の確認事項

### ドキュメント原則の反映

✅ **良好**: すべてのテンプレートに以下の原則が反映されている：
- 「このドキュメントは常に更新」の注意書き
- 「生きているドキュメント」として扱う旨の記載
- 必要最低限の情報に収める旨の記載（要求定義書など）

### Mermaid図の使用

✅ **良好**: すべてのテンプレートで適切にMermaid図が使用されている：
- `flowchart`（フローチャート）
- `sequenceDiagram`（シーケンス図）
- `erDiagram`（ER図）
- `stateDiagram-v2`（状態遷移図）
- `gantt`（ガントチャート）
- `pie`（円グラフ）
- `mindmap`（マインドマップ）

### プレースホルダーの適切性

✅ **良好**: すべてのテンプレートで適切なプレースホルダーが使用されている

---

## 総合評価

### 評価サマリー

- **整合性**: ⚠️ 1箇所の不整合あり（`00_システム理解.md`の「前のステップ」「次のステップ」セクション）
- **完全性**: ✅ すべての必須項目が含まれている
- **一貫性**: ✅ テンプレート間で一貫したフォーマットが使用されている
- **実用性**: ✅ 実用的なテンプレートとして機能している

### 優先度別の修正項目

#### 🔴 高優先度（必須修正）

1. **`00_システム理解.md`の「前のステップ」「次のステップ」セクションの削除**
   - AGENTS.mdの記述と整合させる必要がある
   - 修正後、テンプレートはAGENTS.mdの記述と完全に整合する

#### 🟢 低優先度（任意の改善）

- 現時点で特に問題なし

---

## 推奨される対応

1. **`00_システム理解.md`の修正**: 「前のステップ」「次のステップ」セクションを削除し、「参考資料」セクションのみを残す
2. **修正後の再レビュー**: 修正後、再度レビューを実施し、整合性を確認する

---

## 参考資料

### レビュー対象ファイル

- [`AGENTS.md`](../AGENTS.md)
- [`AGENTS_AI_PLAYBOOK.md`](../AGENTS_AI_PLAYBOOK.md)
- [`.workflow/templates/00_システム理解.md`](../.workflow/templates/00_システム理解.md)
- [`.workflow/templates/00_要求定義.md`](../.workflow/templates/00_要求定義.md)
- [`.workflow/templates/01_要件定義.md`](../.workflow/templates/01_要件定義.md)
- [`.workflow/templates/02_設計.md`](../.workflow/templates/02_設計.md)
- [`.workflow/templates/03_実装計画.md`](../.workflow/templates/03_実装計画.md)
- [`.workflow/templates/04_review.md`](../.workflow/templates/04_review.md)
- [`.workflow/templates/05_最終確認チェックリスト.md`](../.workflow/templates/05_最終確認チェックリスト.md)
- [`.workflow/templates/90_issues.md`](../.workflow/templates/90_issues.md)

---

**レビュー実施日**: 2025年11月23日  
**レビュー担当者**: AI エージェント

